


$('#picture_<%= @picture.id %>').html('<%= j(render 'edit') %>');

import { Application, Controller } from 'stimulus'

class HelloController extends Controller {
  greet() {
    console.log("Hello, Stimulus!", this.element)
  }

  connect() {
    console.log("Connect, Stimulus!", this.element)
  }
}
const application = Application.start()
application.register('attachment', HelloController)

attachToInput({
  input: 'picture_body',
  fileInput: 'picture_file',
  uploadUrl: '<%= detail_picture_path(params[:detail_type], params[:detail_id], @picture.id) %>',
  uploadFieldName: 'picture[file]',
  extraParams: {
    token: '',
    _method: 'patch'
  },
  extraHeaders: {
    'Accept': 'application/json',
    'X-CSRF-Token': $('meta[name="csrf-token"]').attr('content')
  },
  onFileUploaded: function (filename) {
    var img_content = new Image()
    img_content.src = filename
    img_content.classList = 'ui image'
    img_content.height = 30
    img_content.width = 30
    $('#<%= "picture_attachments_#{@picture.id}" %> > .field').last().append(img_content);
  }
});