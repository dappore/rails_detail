$('#detail_pictures_add').html('<%= j(render 'new') %>');

attachToInput({
  input: 'picture_body',
  fileInput: 'picture_file',
  uploadUrl: '<%= detail_pictures_path(params[:detail_type], params[:detail_id]) %>',
  uploadFieldName: 'picture[file]',
  extraHeaders: {
    'Accept': 'application/json',
    'X-CSRF-Token': $('input[name="authenticity_token"]').val()
  },
  onFileUploaded: function(filename, result) {
    console.log(result)
    var img_picture = new Image()
    img_picture.src = filename
    img_picture.classList = 'ui image'
    $('#pickfiles').append(img_picture);

    $('#picture_key').val(filename);
    $('#picture_type').val('Picture');
    $('#avatar_image').attr('src', filename);
  }
});

